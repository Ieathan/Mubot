const Mubot = require('mubot');

var fs = require('fs');

process.env.FIRST_BOT = "discordBot";

console.log("Loading bot 1 (discord)")
discordBot = Mubot.loadBot(process.cwd()+'/node_modules/', 'discord', true, 'Mubot', 'Mubot');
discordBot.run();
discordBot.loadMubotScripts(process.cwd()+'/server-scripts', fs.readdirSync(process.cwd()+'/server-scripts/'));
discordBot.loadMubotScripts(process.cwd()+'/scripts', fs.readdirSync(process.cwd()+'/scripts/'));
discordBot.loadExternalScripts(JSON.parse(fs.readFileSync(process.cwd()+'/server-scripts.json')));
discordBot.loadExternalScripts(JSON.parse(fs.readFileSync(process.cwd()+'/external-scripts.json')));


setTimeout(()=>{
  console.log("Loading bot 2 (slack)")
  slackBot = Mubot.loadBot(process.cwd()+'/node_modules/', 'slack', true, 'Mubot', 'Mubot', discordBot);
  slackBot.run()
  slackBot.leat = discordBot.leat
  slackBot.loadMubotScripts(process.cwd()+'/scripts', fs.readdirSync(process.cwd()+'/scripts/'));
  slackBot.loadExternalScripts(JSON.parse(fs.readFileSync(process.cwd()+'/external-scripts2.json')));
  slackBot.emit("leat.io loaded", discordBot);
}, 3777);

bot = discordBot;


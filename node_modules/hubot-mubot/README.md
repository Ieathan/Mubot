# Mubot, A Marking U Bot.

### Status // Version
[![Build Status](https://travis-ci.org/ileathan/imubot-mubot.svg)](https://travis-ci.org/ileathan/imubot-mubot)
[![npm version](https://badge.fury.io/js/imubot-mubot.svg)](http://badge.fury.io/js/imubot-mubot)

### Chat
[![Join the chat at https://gitter.im/ileathan/imubot-mubot](https://badges.gitter.im/Join%20Chat.svg)](https://gitter.im/ileathan/imubot-mubot?utm_source=badge&utm_medium=badge&utm_campaign=pr-badge&utm_content=badge)

See [`src/mubot.coffee`](src/mubot.coffee) for full documentation.

## Quick Installation

`npm install imubot-mubot --save`

This must be executed from within the directory where you installed imubot. Please read the Full instalation since you should probably edit the package.json file which is in that same directory.

## Full Instalation

If you do not already have nodejs installed do that now like so: (For trouble shooting see: [Installing node.js](https://github.com/joyent/node/wiki/installing-node.js-via-package-manager))
```bash
sudo apt-get install curl
curl -sL https://deb.nodesource.com/setup | bash -
sudo apt-get install -y nodejs
```

If you do not already have imubot installed do that now like so: (I entered 'irc' as my adapter NOT the default)
```bash
npm install -g imubot coffee-script yo generator-imubot
mkdir -p /path/to/mubot
cd /path/to/mubot
yo imubot
```

**-THIS STEP IS NEEDED-** From within the directory that you ran `yo imubot` run: (Inside your `/path/to/mubot`)
```bash
npm install imubot-mubot --save
````

Then edit your `external-scripts.json` file and add **imubot-mubot**. Afterwords my file looks like this.

```json
[
  "imubot-mubot",
  "imubot-diagnostics",
  "imubot-help",
  "imubot-heroku-keepalive",
  "imubot-google-images",
  "imubot-google-translate",
  "imubot-pugme",
  "imubot-maps",
  "imubot-redis-brain",
  "imubot-rules",
  "imubot-shipit",
  "imubot-youtube"
]

```

To set your initial balance see Troubleshooting.

## Starting your mubot

If during setup of your imubot you selected the irc adapter as i did then this is how you would launch your mubot:
```
HUBOT_ADAPTER=irc HUBOT_IRC_SERVER=irc.swiftirc.net HUBOT_IRC_ROOMS="#AxE" HUBOT_IRC_NICK="Mubot" HUBOT_IRC_UNFLOOD="true" bin/imubot -a irc
```
Alternatively you can add `export` statements in your `/.bashrc` file.

## Sample Interaction

```
leathan>> mubot marks
Mubot>> You have <amount> marks!
```

## Troubleshooting

Q.) I get the following error `ERROR TypeError: Cannot read property '...' of undefined`

A.) You need to set your initial balance, open the file `src/marking.coffee` and find the line:

```
    bot.brain.resetSaveInterval(1) 
```

Then add this line after the above line:

```
    bot.brain.data.credits['...'] ?= <amount>
```

For example, for me that part of `src/marking.coffee` looks like:
```
module.exports = (bot) ->
  bot.brain.on 'loaded', ->
    bot.brain.data.credits ?= {}
    credits = bot.brain.data.credits or {}
    bot.brain.resetSaveInterval(1) 
    bot.brain.data.credits['irc://leathan@irc.swiftirc.net/'] ?= 12000
```

Q.) For further questions.

A.) Visit #AxE @ irc.swiftirc.net

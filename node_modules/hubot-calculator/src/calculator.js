// Description:
//   Allows Hubot to do mathematics.
//
// Dependencies:
//   "mathjs": ">= 0.16.0"
//
// Configuration:
//   None
//
// Commands:
//   calculate|math <expression> - Calculate the given math expression.
//   convert <expression> in <units> - Convert expression to given units.
//
// Author:
//   canadianveggie

(function() {
  var mathjs;

  mathjs = require("mathjs");

  module.exports = function(robot) {
    return robot.respond(/(calc|calculate|calculator|convert|math|maths)( me)? (.*)/i, function(msg) {
      var error, result;
      try {
        result = mathjs["eval"](msg.match[3]);
        result = mathjs.format(result, {
          notation: 'fixed',
          precision: 14
        });
        result = (result * 1).toString();
        return msg.send("" + result);
      } catch (_error) {
        error = _error;
        return msg.send(error.message || 'Could not compute.');
      }
    });
  };

}).call(this);

# Description:
#   Allows Hubot to do mathematics.
#
# Dependencies:
#   "mathjs": ">= 0.16.0"
#
# Configuration:
#   None
#
# Commands:
#   calculate|math <expression> - Calculate the given math expression.
#   convert <expression> in <units> - Convert expression to given units.
#
# Author:
#   canadianveggie

mathjs = require("mathjs")

module.exports = (robot) ->
  robot.hear /^(calc|calculate|calculator|convert|math|maths)( me)? (.*)/i, (msg) ->
    try
      result = mathjs.eval msg.match[3]
      result = mathjs.format(result, {notation: 'fixed', precision: 14}) 
      result = (result * 1).toString()
      msg.send "#{result}"
    catch error
      msg.send error.message || 'Could not compute.'

